<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Onboarding - Doom Blocker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button {
            background: #ff4444;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #cc3333;
        }
        .success {
            background: #4CAF50;
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            display: none;
        }
        .status {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
        }
        .test-link {
            background: #007bff;
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 4px;
            display: inline-block;
            margin: 10px 5px;
        }
        .test-link:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Onboarding Reset Tool</h1>
        <p>Use this tool to reset the onboarding state for testing purposes.</p>

        <div class="status" id="status">
            <strong>Current Status:</strong> <span id="statusText">Checking...</span>
        </div>

        <div class="success" id="successMessage"></div>

        <h3>Actions:</h3>
        <button onclick="resetOnboarding()">üîÑ Reset Onboarding</button>
        <button onclick="checkStatus()">üîç Check Status</button>

        <h3>Test Onboarding:</h3>
        <a href="https://www.youtube.com/?doomGuide=1" target="_blank" class="test-link">
            üéØ Test on YouTube
        </a>
        <a href="https://www.youtube.com/#doomGuide=1" target="_blank" class="test-link">
            üéØ Test with Hash
        </a>

        <h3>Instructions:</h3>
        <ol>
            <li>Click "Reset Onboarding" to clear the completion flag</li>
            <li>Click one of the test links above</li>
            <li>Onboarding should appear (first time only)</li>
            <li>Close the onboarding overlay</li>
            <li>Visit the link again - onboarding should NOT appear</li>
            <li>Use "Reset Onboarding" to test again</li>
        </ol>
    </div>

    <script>
        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 3000);
        }

        function updateStatus(status) {
            document.getElementById('statusText').textContent = status;
        }

        function resetOnboarding() {
            if (typeof chrome !== 'undefined' && chrome.storage) {
                chrome.storage.local.remove(['onboardingCompleted'], () => {
                    console.log('‚úÖ Onboarding state reset');
                    showSuccess('‚úÖ Onboarding reset! You can now test it again.');
                    checkStatus();
                });
            } else {
                // For testing outside extension context
                localStorage.removeItem('onboardingCompleted');
                showSuccess('‚úÖ Onboarding reset (localStorage)! You can now test it again.');
                updateStatus('Reset (localStorage fallback)');
            }
        }

        function checkStatus() {
            if (typeof chrome !== 'undefined' && chrome.storage) {
                chrome.storage.local.get(['onboardingCompleted'], (result) => {
                    const completed = result.onboardingCompleted;
                    updateStatus(completed ?
                        'Onboarding has been completed (will not show)' :
                        'Onboarding has NOT been completed (will show on doomGuide=1)'
                    );
                });
            } else {
                // For testing outside extension context
                const completed = localStorage.getItem('onboardingCompleted');
                updateStatus(completed ?
                    'Onboarding has been completed (localStorage)' :
                    'Onboarding has NOT been completed (localStorage)'
                );
            }
        }

        // Check status on page load
        document.addEventListener('DOMContentLoaded', checkStatus);

        console.log('üîß Onboarding Reset Tool loaded');
        console.log('üìù Use this page to reset onboarding state for testing');
    </script>
</body>
</html>